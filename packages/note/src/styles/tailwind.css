/* https://github.com/saadeghi/daisyui/issues/4209#issuecomment-3512250505 */
@layer theme, base, components, utilities.daisyui.component;
@import "tailwindcss";
@import "./daisyui.css";
@import "./dictionary.css";
@import "./tailwindProperty.css";
@import "./configurable.css";

/* biome-ignore format: this looks nicer */
@theme {
  --animate-fade-in: fade-in 400ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  --animate-fade-in-sm: fade-in-sm 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  @keyframes fade-in {
    from { opacity: 0; transform: translateY(4px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fade-in-sm {
    from { opacity: 0; transform: translateY(2px); }
    to { opacity: 1; transform: translateY(0); }
  }

  --animate-slide-to-left: slide-to-left 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  --animate-slide-to-right: slide-to-right 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  --animate-slide-from-left: slide-from-left 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  --animate-slide-from-right: slide-from-right 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  @keyframes slide-to-left {
    from { transform: translateX(0); }
    to   { transform: translateX(-100%); }
  }
  @keyframes slide-to-right {
    from { transform: translateX(0); }
    to   { transform: translateX(100%); }
  }
  @keyframes slide-from-left {
    from { transform: translateX(-100%); }
    to   { transform: translateX(0); }
  }
  @keyframes slide-from-right {
    from { transform: translateX(100%); }
    to   { transform: translateX(0); }
  }

  --animate-unclip: unclip 600ms cubic-bezier(0.65, 0, 0.35, 1) forwards;
  @keyframes unclip {
    0% {
      clip-path: polygon(100% 100%, 100% 100%, 100% 100%);
    }
  }

  --animate-modal-in: modal-in 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  --animate-modal-out: modal-out 300ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  @keyframes modal-in {
    from { opacity: 0; transform: translateY(4px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes modal-out {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(4px); }
  }
}

@custom-variant hover (&:hover);

@utility gutter-stable {
  scrollbar-gutter: stable;
}

@layer components {
  /* biome-ignore lint: root */
  :root::view-transition-group(root) {
    animation: none;
  }

  :root[data-transition-direction="forward"]::view-transition-old(slide-root) {
    animation: var(--animate-slide-to-left);
  }
  :root[data-transition-direction="forward"]::view-transition-new(slide-root) {
    animation: var(--animate-slide-from-right);
  }
  :root[data-transition-direction="back"]::view-transition-old(slide-root) {
    animation: var(--animate-slide-to-right);
  }
  :root[data-transition-direction="back"]::view-transition-new(slide-root) {
    animation: var(--animate-slide-from-left);
  }
  :root[data-transition-direction] ::part(root-part) {
    view-transition-name: slide-root;
  }

  :root[data-theme-transition="true"]::view-transition-old(angled-swipe) {
    animation: none;
    z-index: -1;
  }
  :root[data-theme-transition="true"]::view-transition-new(angled-swipe) {
    animation: var(--animate-unclip);
    clip-path: polygon(-100vmax 100%, 100% 100%, 100% -100vmax);
  }
  :root[data-theme-transition="true"] ::part(root-part) {
    view-transition-name: angled-swipe;
  }

  :root::view-transition-old(modal-fade) {
    animation: var(--animate-modal-out);
  }
  :root::view-transition-new(modal-fade) {
    animation: var(--animate-modal-in);
  }
  :root ::part(picture-modal) {
    view-transition-name: modal-fade;
  }
}

@layer utilities {
  .pitch-segment {
    position: relative;
  }
  .pitch-segment::after {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    width: 2px;
    height: 8px;
  }

  [data-is-even="true"] .pitch-segment::after {
    background-color: var(--color-primary); /* match text/border color */
  }
  [data-is-even="false"] .pitch-segment::after {
    background-color: var(--color-secondary); /* match text/border color */
  }

  .picture-field-background {
    @apply [&_*:not(img)]:contents;
    @apply [&_:not(:first-child)]:hidden;
    @apply absolute size-full [&_img]:size-full [&_img]:object-cover [&_img]:scale-110 [&_img]:filter [&_img]:brightness-50 [&_img]:blur-[16px];
  }

  .picture-field {
    @apply [&_*:not(img)]:contents;
    @apply [&_:not(:first-child)]:hidden;
    @apply relative h-48 sm:h-56 cursor-pointer [&_img]:h-full [&_img]:object-contain [&_img]:hover:filter-none;
    &[data-nsfw="true"],
    &[data-tags~="nsfw"],
    &[data-tags~="NSFW"],
    &[data-tags~="Nsfw"] {
      @apply [&_img]:filter [&_img]:blur-[16px] [&_img]:brightness-50;
    }
    &[data-transition="true"] {
      @apply [&_img]:transition-[filter];
    }
  }

  [data-blur-nsfw="false"] .picture-field {
    @apply [&_img]:filter-none;
  }

  .picture-field-container {
    display: none;
    &:not([data-has-picture=""]) {
      display: flex;
    }
  }

  [data-side="front"][data-picture-on-front="false"] .picture-field-container {
    display: none;
  }

  [data-side="front"] .picture-field,
  [data-side="front"] .picture-field-background {
    @apply opacity-0;
  }

  .picture-field:hover {
    @apply [&_img]:filter-none;
  }

  .pitch-field {
    @apply hidden;
    &[data-has-pitch="true"] {
      @apply flex;
    }
  }

  .hint-field {
    @apply hidden;
    &[data-has-hint="true"] {
      @apply flex;
    }
  }

  [data-mod-vertical="true"] .vertical-rl {
    writing-mode: vertical-rl;
  }

  .horizontal-tb {
    writing-mode: horizontal-tb;
  }
}

@font-face {
  font-family: "Hina Mincho";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("_kiku_font_hina-mincho.woff2") format("woff2");
}

@font-face {
  font-family: "Klee One";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("_kiku_font_klee-one.woff2") format("woff2");
}

@font-face {
  font-family: "IBM Plex Sans JP";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("_kiku_font_ibm-plex-sans-jp.woff2") format("woff2");
}

:root {
  font-size: 16px;
  scrollbar-gutter: stable;
}

*,
:after,
:before,
::backdrop {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: var(--color-base-100);
}

*::-webkit-scrollbar {
  background-color: var(--color-base-200) !important;
}

*::-webkit-scrollbar-thumb {
  background-color: var(--color-base-content-subtle-200) !important;
}

*::-webkit-scrollbar-thumb:hover {
  background-color: var(--color-base-content-subtle-300) !important;
}

@media (min-width: 40rem) {
  *::-webkit-scrollbar {
    width: 10px !important;
    border-radius: 0 !important;
  }
}

#kiku-root {
  position: relative;
  overflow: hidden;
}

/* AnkiDroid */
.android body > div#content {
  margin: 0;
}
